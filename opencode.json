{
  "$schema": "https://opencode.ai/config.json",
  "instructions": ["/Users/buddhi/.config/opencode/AGENTS.md"],
  "permission": {
    "edit": "allow",
    "bash": "allow",
    "write": "allow"
  },
  "command": {
    "opencode-init": {
      "description": "Initialize opencode - Check tools, install missing, start services, initialize workspace",
      "template": "You are an opencode initialization assistant. Use the `question` tool to present options to the user for interactive selection.\n\n## Step 1: Check System Tools\n\nRun these commands to get the system tools status:\n\n```\ncommand -v cm && echo \"cm: INSTALLED\" || echo \"cm: MISSING\"\ncommand -v bd && echo \"bd: INSTALLED\" || echo \"bd: MISSING\"\ncommand -v bv && echo \"bv: INSTALLED\" || echo \"bv: MISSING\"\ncommand -v tldr && echo \"tldr: INSTALLED\" || echo \"tldr: MISSING\"\ncommand -v biome && echo \"biome: INSTALLED\" || echo \"biome: MISSING\"\ncommand -v prettier && echo \"prettier: INSTALLED\" || echo \"prettier: MISSING\"\ncommand -v ubs && echo \"ubs: INSTALLED\" || echo \"ubs: MISSING\"\ncommand -v opencode-init && echo \"opencode-init: IN_PATH\" || echo \"opencode-init: NOT_IN_PATH\"\n```\n\n## Step 2: Check Running Services\n\nRun these commands to get the services status:\n\n```\n# Check TLDR daemon\nTLDR_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" http://localhost:3000/health 2>/dev/null || echo \"000\")\n[ \"$TLDR_STATUS\" = \"200\" ] && echo \"tldr: RUNNING\" || echo \"tldr: STOPPED\"\n\n# Check GPTCache\nGPTCACHE_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" http://localhost:8000/cache_status 2>/dev/null || echo \"000\")\n[ \"$GPTCACHE_STATUS\" = \"200\" ] && echo \"gptcache: RUNNING\" || echo \"gptcache: STOPPED\"\n\n# Check cass_memory\npgrep -f \"cass_memory\" > /dev/null 2>&1 && echo \"cass_memory: RUNNING\" || echo \"cass_memory: STOPPED\"\n```\n\n## Step 3: Check Workspace Initialization\n\nRun these commands to get the workspace status:\n\n```\n[ -d \".git\" ] && echo \"git: INITIALIZED\" || echo \"git: NOT_INITIALIZED\"\n[ -d \".beads\" ] && echo \"beads: INITIALIZED\" || echo \"beads: NOT_INITIALIZED\"\n[ -d \".cass\" ] && echo \"cass_workspace: INITIALIZED\" || echo \"cass_workspace: NOT_INITIALIZED\"\n[ -d \".tldr\" ] && echo \"tldr_index: CREATED\" || echo \"tldr_index: NOT_CREATED\"\n[ -f \"biome.json\" ] && echo \"biome: PRESENT\" || echo \"biome: MISSING\"\n[ -f \".prettierrc\" ] && echo \"prettier: PRESENT\" || echo \"prettier: MISSING\"\n[ -f \"opencode.json\" ] && echo \"opencode_json: PRESENT\" || echo \"opencode_json: MISSING\"\n[ -f \".git/hooks/pre-commit\" ] && echo \"git_hooks: INSTALLED\" || echo \"git_hooks: NOT_INSTALLED\"\n```\n\n## Step 4: Present Status Report\n\nCreate a clear status report with emoji:\n\n### üõ†Ô∏è System Tools\n| Tool | Status |\n|------|--------|\n| cm (cass_memory) | INSTALLED/MISSING |\n| bd (Beads CLI) | INSTALLED/MISSING |\n| bv (Beads Viewer) | INSTALLED/MISSING |\n| TLDR | INSTALLED/MISSING |\n| Biome | INSTALLED/MISSING |\n| Prettier | INSTALLED/MISSING |\n| UBS | INSTALLED/MISSING |\n\n### üîÑ Services\n| Service | Status | Port |\n|---------|--------|------|\n| TLDR daemon | RUNNING/STOPPED | 3000 |\n| GPTCache | RUNNING/STOPPED | 8000 |\n| cass_memory | RUNNING/STOPPED | - |\n\n### üìÅ Workspace\n| Component | Status |\n|-----------|--------|\n| Git | INITIALIZED/NOT_INITIALIZED |\n| Beads | INITIALIZED/NOT_INITIALIZED |\n| cass_memory | INITIALIZED/NOT_INITIALIZED |\n| TLDR index | CREATED/NOT_CREATED |\n| biome.json | PRESENT/MISSING |\n| .prettierrc | PRESENT/MISSING |\n| opencode.json | PRESENT/MISSING |\n| Git hooks | INSTALLED/NOT_INSTALLED |\n\n## Step 5: Use question Tool for Interactive Selection\n\nUse the `question` tool to present options:\n\n```javascript\nawait question({\n  questions: [\n    {\n      header: \"OpenCode Setup\",\n      question: \"What would you like to do? Select an option:\",\n      options: [\n        {\n          label: \"Install Tools\",\n          description: \"Install missing system tools (~5 min)\"\n        },\n        {\n          label: \"Start Services\",\n          description: \"Start TLDR, GPTCache, and cass_memory\"\n        },\n        {\n          label: \"Init Workspace\",\n          description: \"Initialize this project workspace\"\n        },\n        {\n          label: \"Do All\",\n          description: \"Install tools, start services, init workspace\"\n        },\n        {\n          label: \"Skip\",\n          description: \"Don't do anything\"\n        }\n      ]\n    }\n  ]\n})\n```\n\n## Step 6: Execute Based on Selection\n\nBased on the user's selection, execute the appropriate commands:\n\n### If \"Install Tools\" or \"Do All\":\nRun: `~/.config/opencode/bin/opencode-init --quiet`\n\n### If \"Start Services\" or \"Do All\":\nRun these commands:\n```\n# Start TLDR daemon (if installed)\ncommand -v tldr && tldr daemon start 2>/dev/null\n\n# Start GPTCache (if installed)\ncommand -v gptcache-server && gptcache-server &\n\n# Start cass_memory (if installed)\ncommand -v cass_memory && cass_memory --daemon & 2>/dev/null || cass_memory serve & 2>/dev/null\n```\n\n### If \"Init Workspace\" or \"Do All\":\nRun: `~/.config/opencode/bin/workspace-init --force`\n\n## Step 7: Report Results\n\nAfter execution, provide a clear summary:\n\n### ‚úÖ Completed Actions\n- List all actions that were performed\n- List all tools installed\n- List all services started\n- List all workspace components initialized\n\n### ‚ùå Errors\n- Report any errors that occurred\n- Suggest fixes if possible\n\n### üí° Next Steps\n- Suggest useful commands to run next\n- Example: \"Run `bd ready` to see available tasks\"\n- Example: \"Run `cm context \\\"your task\\\"` to get context\"\n\n## Important Notes\n\n- Always use the `question` tool for user selection - don't ask them to type responses\n- Be clear about what will happen before executing\n- Use emoji (‚úÖ ‚ùå ‚ö†Ô∏è üîÑ üõ†Ô∏è üìÅ üîÑ) for visual clarity\n- Confirm successful startup of services\n- Report errors in a user-friendly way",
      "agent": "build"
    }
  },
  "provider": {
    "glm-47": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Z.AI",
      "options": {
        "baseURL": "https://api.z.ai/api/coding/paas/v4"
      },
      "models": {
        "glm-4.7": {
          "name": "GLM 4.7 BYOM",
          "limit": {
            "context": 200000,
            "output": 8192
          }
        }
      }
    },
    "glm-46": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Z.AI",
      "options": {
        "baseURL": "https://api.z.ai/api/coding/paas/v4"
      },
      "models": {
        "glm-4.6": {
          "name": "GLM 4.6 BYOM",
          "limit": {
            "context": 200000,
            "output": 8192
          }
        }
      }
    },
    "gemini-2-5-pro": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Google AI",
      "options": {
        "baseURL": "https://generativelanguage.googleapis.com/v1beta/"
      },
      "models": {
        "gemini-2.5-pro": {
          "name": "Gemini 2.5 Pro [Google]",
          "limit": {
            "context": 1000000,
            "output": 65536
          }
        }
      }
    },
    "gemini-3-pro": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Google AI",
      "options": {
        "baseURL": "https://generativelanguage.googleapis.com/v1beta/"
      },
      "models": {
        "gemini-3.0-pro": {
          "name": "Gemini 3.0 Pro [Google]",
          "limit": {
            "context": 1000000,
            "output": 65536
          }
        }
      }
    },
    "kimi-thinking-moonshot": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Moonshot AI",
      "options": {
        "baseURL": "https://api.moonshot.ai/v1"
      },
      "models": {
        "kimi-k2-thinking": {
          "name": "Kimi K2 Thinking (MoonshotAI)",
          "limit": {
            "context": 256000,
            "output": 32768
          }
        }
      }
    },
    "kimi-thinking-fireworks": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Fireworks AI",
      "options": {
        "baseURL": "https://api.fireworks.ai/inference/v1"
      },
      "models": {
        "accounts/fireworks/models/kimi-k2-thinking": {
          "name": "Kimi K2 Thinking [Fireworks]",
          "limit": {
            "context": 256000,
            "output": 16384
          }
        }
      }
    }
  },
  "plugin": [
    "./plugin/gptcache.mjs",
    "./plugin/cass.mjs",
    "./plugin/beads.mjs",
    "./plugin/beads-tools.mjs",
    "./plugin/setup.mjs",
    "./plugin/init-commands.mjs",
    "./plugin/tldr.mjs"
  ]
}
