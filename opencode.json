{
  "$schema": "https://opencode.ai/config.json",
  "instructions": ["/Users/buddhi/.config/opencode/AGENTS.md"],
  "permission": {
    "edit": "allow",
    "bash": "allow",
    "write": "allow"
  },
  "command": {
    "opencode-init": {
      "description": "Initialize opencode - Check tools, install missing, start services, initialize workspace",
      "template": "You are an opencode initialization assistant. Your job is to check the current state, help the user set up opencode, and ensure all services are running.\n\n## Step 1: Check System Tools\n\nRun these commands to check if tools are installed:\n\n```\n# System tools\ncommand -v cm && echo \"cm: ‚úÖ installed\" || echo \"cm: ‚ùå missing\"\ncommand -v bd && echo \"bd: ‚úÖ installed\" || echo \"bd: ‚ùå missing\"\ncommand -v bv && echo \"bv: ‚úÖ installed\" || echo \"bv: ‚ùå missing\"\ncommand -v tldr && echo \"tldr: ‚úÖ installed\" || echo \"tldr: ‚ùå missing\"\ncommand -v biome && echo \"biome: ‚úÖ installed\" || echo \"biome: ‚ùå missing\"\ncommand -v prettier && echo \"prettier: ‚úÖ installed\" || echo \"prettier: ‚ùå missing\"\ncommand -v ubs && echo \"ubs: ‚úÖ installed\" || echo \"ubs: ‚ùå missing\"\ncommand -v opencode-init && echo \"opencode-init: ‚úÖ in PATH\" || echo \"opencode-init: ‚ùå not in PATH\"\n```\n\n## Step 2: Check Running Services\n\nCheck if services are running:\n\n```\n# Check TLDR daemon\nTLDR_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" http://localhost:3000/health 2>/dev/null || echo \"000\")\nif [ \"$TLDR_STATUS\" = \"200\" ]; then\n    echo \"TLDR daemon: ‚úÖ running (port 3000)\"\nelse\n    echo \"TLDR daemon: ‚ùå not running (status: $TLDR_STATUS)\"\nfi\n\n# Check GPTCache\nGPTCACHE_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" http://localhost:8000/cache_status 2>/dev/null || echo \"000\")\nif [ \"$GPTCACHE_STATUS\" = \"200\" ]; then\n    echo \"GPTCache: ‚úÖ running (port 8000)\"\nelse\n    echo \"GPTCache: ‚ùå not running (status: $GPTCACHE_STATUS)\"\nfi\n\n# Check cass_memory server\nif pgrep -f \"cass_memory\" > /dev/null 2>&1; then\n    echo \"cass_memory: ‚úÖ running\"\nelse\n    echo \"cass_memory: ‚ùå not running\"\nfi\n```\n\n## Step 3: Check Workspace Initialization\n\nRun these commands to check workspace status:\n\n```\n# Workspace tools\n[ -d \".git\" ] && echo \"git: ‚úÖ initialized\" || echo \"git: ‚ùå not initialized\"\n[ -d \".beads\" ] && echo \"beads: ‚úÖ initialized\" || echo \"beads: ‚ùå not initialized\"\n[ -d \".cass\" ] && echo \"cass_memory: ‚úÖ initialized\" || echo \"cass_memory: ‚ùå not initialized\"\n[ -d \".tldr\" ] && echo \"tldr: ‚úÖ indexed\" || echo \"tldr: ‚ùå not indexed\"\n[ -f \"biome.json\" ] && echo \"biome.json: ‚úÖ present\" || echo \"biome.json: ‚ùå missing\"\n[ -f \".prettierrc\" ] && echo \".prettierrc: ‚úÖ present\" || echo \".prettierrc: ‚ùå missing\"\n[ -f \"opencode.json\" ] && echo \"opencode.json: ‚úÖ present\" || echo \"opencode.json: ‚ùå missing\"\n[ -f \".git/hooks/pre-commit\" ] && echo \"git-hooks: ‚úÖ installed\" || echo \"git-hooks: ‚ùå missing\"\n```\n\n## Step 4: Present Status Report\n\nCreate a nice markdown table showing:\n\n### System Tools Status\n| Tool | Status | Action |\n|------|--------|--------|\n| cm (cass_memory) | ‚úÖ/‚ùå | - |\n| bd (Beads CLI) | ‚úÖ/‚ùå | - |\n| bv (Beads Viewer) | ‚úÖ/‚ùå | - |\n| TLDR | ‚úÖ/‚ùå | - |\n| Biome | ‚úÖ/‚ùå | - |\n| Prettier | ‚úÖ/‚ùå | - |\n| UBS | ‚úÖ/‚ùå | - |\n\n### Services Status\n| Service | Status | Port | Action |\n|---------|--------|------|--------|\n| TLDR daemon | ‚úÖ/‚ùå | 3000 | start/stop |\n| GPTCache | ‚úÖ/‚ùå | 8000 | start/stop |\n| cass_memory | ‚úÖ/‚ùå | - | start/stop |\n\n### Workspace Status\n| Component | Status | Action |\n|-----------|--------|--------|\n| Git | ‚úÖ/‚ùå | - |\n| Beads | ‚úÖ/‚ùå | - |\n| cass_memory | ‚úÖ/‚ùå | - |\n| TLDR index | ‚úÖ/‚ùå | - |\n| biome.json | ‚úÖ/‚ùå | - |\n| .prettierrc | ‚úÖ/‚ùå | - |\n| opencode.json | ‚úÖ/‚ùå | - |\n| Git hooks | ‚úÖ/‚ùå | - |\n\n## Step 5: Offer Options\n\nAsk the user what they want to do:\n\n1. **Install missing system tools** - Run `~/.config/opencode/bin/opencode-init --quiet`\n2. **Start all services** - Run:\n   - `tldr daemon start` (if installed)\n   - `gptcache-server &` (if installed)\n   - `cass_memory --daemon &` (if installed)\n3. **Initialize workspace** - Run `~/.config/opencode/bin/workspace-init --force`\n4. **Do all of the above** - Install tools, start services, init workspace\n5. **Skip** - Don't do anything\n\nWait for user input and then execute the appropriate command(s).\n\n## Step 6: Execute and Report\n\nAfter running the chosen commands, summarize what was done:\n\n### For System Installation:\n- List all tools that were installed\n\n### For Services Started:\n- List all services that were started\n- Report any failures\n\n### For Workspace Init:\n- List all components that were initialized\n\n### Report Errors:\n- Report errors in a user-friendly way\n- Suggest next steps (e.g., \"Run `bd ready` to see available tasks\")\n\n## Important\n\n- Always be clear about what's missing and what will be installed/started\n- Confirm with user before making changes\n- Report errors in a user-friendly way\n- Use emoji (‚úÖ ‚ùå ‚ö†Ô∏è üîÑ) for visual status indicators\n- Services to check and start:\n  - TLDR daemon: `tldr daemon start`\n  - GPTCache: `gptcache-server &`\n  - cass_memory: `cass_memory --daemon &` or `cass_memory serve &`",
      "agent": "build"
    }
  },
  "provider": {
    "glm-47": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Z.AI",
      "options": {
        "baseURL": "https://api.z.ai/api/coding/paas/v4"
      },
      "models": {
        "glm-4.7": {
          "name": "GLM 4.7 BYOM",
          "limit": {
            "context": 200000,
            "output": 8192
          }
        }
      }
    },
    "glm-46": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Z.AI",
      "options": {
        "baseURL": "https://api.z.ai/api/coding/paas/v4"
      },
      "models": {
        "glm-4.6": {
          "name": "GLM 4.6 BYOM",
          "limit": {
            "context": 200000,
            "output": 8192
          }
        }
      }
    },
    "gemini-2-5-pro": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Google AI",
      "options": {
        "baseURL": "https://generativelanguage.googleapis.com/v1beta/"
      },
      "models": {
        "gemini-2.5-pro": {
          "name": "Gemini 2.5 Pro [Google]",
          "limit": {
            "context": 1000000,
            "output": 65536
          }
        }
      }
    },
    "gemini-3-pro": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Google AI",
      "options": {
        "baseURL": "https://generativelanguage.googleapis.com/v1beta/"
      },
      "models": {
        "gemini-3.0-pro": {
          "name": "Gemini 3.0 Pro [Google]",
          "limit": {
            "context": 1000000,
            "output": 65536
          }
        }
      }
    },
    "kimi-thinking-moonshot": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Moonshot AI",
      "options": {
        "baseURL": "https://api.moonshot.ai/v1"
      },
      "models": {
        "kimi-k2-thinking": {
          "name": "Kimi K2 Thinking (MoonshotAI)",
          "limit": {
            "context": 256000,
            "output": 32768
          }
        }
      }
    },
    "kimi-thinking-fireworks": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "Fireworks AI",
      "options": {
        "baseURL": "https://api.fireworks.ai/inference/v1"
      },
      "models": {
        "accounts/fireworks/models/kimi-k2-thinking": {
          "name": "Kimi K2 Thinking [Fireworks]",
          "limit": {
            "context": 256000,
            "output": 16384
          }
        }
      }
    }
  },
  "plugin": [
    "./plugin/gptcache.mjs",
    "./plugin/cass.mjs",
    "./plugin/beads.mjs",
    "./plugin/beads-tools.mjs",
    "./plugin/setup.mjs",
    "./plugin/init-commands.mjs",
    "./plugin/tldr.mjs"
  ]
}
